<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV - Baltazar Dimayuga</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.3;
            color: #000;
            background-color: #f0f0f0;
            padding: 15px;
            font-size: 12px;
        }
        
        .cv-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .header {
            background: #ffffff;
            color: black;
            padding: 0 0 12px 0;
            text-align: center;
            border-bottom: 2px solid #333;
            margin-bottom: 15px;
        }
        
        .header h1 {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #333;
        }
        
        .header .title {
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: normal;
            color: #666;
        }
        
        .contact-info {
            font-size: 11px;
            text-align: center;
            margin-bottom: 5px;
            line-height: 1.3;
        }
        
        .contact-info div {
            margin-bottom: 1px;
            display: inline-block;
            margin-right: 15px;
        }
        
        .contact-info a {
            color: #333;
            text-decoration: underline;
            font-weight: normal;
        }
        
        .content {
            padding: 0;
        }
        
        .section {
            margin-bottom: 15px;
        }
        
        .section-title {
            color: #333;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            border-bottom: 1px solid #333;
            padding-bottom: 3px;
            margin-bottom: 8px;
            letter-spacing: 0.3px;
        }
        
        .profile-content {
            font-size: 11px;
            line-height: 1.4;
            text-align: justify;
            color: #333;
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 4px;
            border-bottom: 1px solid #eee;
            padding-bottom: 2px;
        }
        
        .item-details {
            display: flex;
            flex-direction: column;
        }
        
        .item-title {
            font-weight: bold;
            font-size: 12px;
            color: #333;
        }
        
        .item-company {
            font-size: 11px;
            color: #666;
            font-style: italic;
        }
        
        .item-subtitle {
            font-size: 10px;
            color: #888;
            font-style: normal;
            margin-top: 1px;
        }
        
        .item-date {
            font-size: 10px;
            color: #666;
            font-weight: normal;
            white-space: nowrap;
        }
        
        .item-content {
            font-size: 10px;
            line-height: 1.3;
            clear: both;
            margin-left: 0;
        }
        
        .item-content ul {
            margin-left: 15px;
            margin-top: 3px;
        }
        
        .item-content li {
            margin-bottom: 3px;
            text-align: justify;
        }
        
        .skills-category {
            margin-bottom: 8px;
        }
        
        .skills-category-title {
            font-weight: bold;
            font-size: 11px;
            color: #333;
            margin-bottom: 3px;
            text-transform: uppercase;
        }
        
        .skills-list {
            font-size: 10px;
            line-height: 1.3;
            color: #333;
        }
        
        .cover-letter-container {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            padding: 30px;
            line-height: 1.6;
            font-family: 'Arial', sans-serif;
            color: black;
        }
        
        .letter-header {
            text-align: right;
            margin-bottom: 30px;
            font-size: 12px;
        }
        
        .letter-recipient {
            text-align: left;
            margin-bottom: 30px;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .letter-recipient strong {
            font-weight: bold;
        }
        
        .letter-greeting {
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .letter-body {
            font-size: 14px;
            line-height: 1.6;
            text-align: justify;
        }
        
        .letter-body p {
            margin-bottom: 15px;
        }
        
        .letter-closing {
            margin-top: 30px;
            font-size: 14px;
        }
        
        .letter-signature {
            margin-top: 30px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .download-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .view-buttons, .buttons-row {
            display: flex;
            gap: 10px;
        }
        
        .view-btn, .download-btn {
            background: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .view-btn:hover, .download-btn:hover {
            background: #555;
        }
        
        .view-btn.active {
            background: #555;
        }
        
        .job-link-container {
            margin-top: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #ddd;
            text-align: center;
            display: none;
        }
        
        .job-link-container h3 {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }
        
        .job-link-container a.job-btn {
            display: inline-block;
            background: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .job-link-container a.job-btn:hover {
            background: #555;
        }
        
        @media print {
            .download-buttons, .job-link-container {
                display: none !important;
            }
            body {
                background: white;
                padding: 0;
            }
            .cv-container {
                box-shadow: none;
                border: none;
                margin: 0;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <!-- CV Version -->
    <div class="cv-container" id="cv-content">
        <div class="header">
            <h1>Baltazar Dimayuga</h1>
            <div class="title">Data Analyst Jr | Business Intelligence</div>
            <div class="contact-info">
                <div>Teléfono: (+52) 747 155 8247</div>
                <div>Email: <a href="mailto:baltazardv13@gmail.com">baltazardv13@gmail.com</a></div>
                <div>Ubicación: Guerrero, México</div>
                <div>GitHub: <a href="https://github.com/BaltazarDV" target="_blank">github.com/BaltazarDV</a></div>
                <div>LinkedIn: <a href="https://www.linkedin.com/in/baltazar-dimayuga-4000a2293" target="_blank">linkedin.com/in/baltazar-dimayuga</a></div>
            </div>
        </div>
        
        <div class="content">
            <div class="section">
                <h2 class="section-title">Perfil Profesional</h2>
                <div class="profile-content">
                    Analista de Datos Jr e Ingeniero en Computación especializado en Python, SQL, Power BI y visualización de datos. Experiencia comprobada en automatización de procesos (reducción del 40% en tiempos), optimización técnica (disminución del 20% en incidencias) y crecimiento empresarial (incremento del 60% en ventas). Busco aplicar mis habilidades analíticas como Data Analyst Jr para generar valor empresarial mediante Business Intelligence.
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Habilidades Técnicas e Idiomas</h2>
                
                <div class="skills-category">
                    <div class="skills-category-title">Análisis de Datos y BI</div>
                    <div class="skills-list">Python (Avanzado) • SQL (Avanzado) • Pandas/NumPy (Avanzado) • Power BI (Intermedio) • Tableau (Básico) • Excel Avanzado • Matplotlib/Seaborn • EDA • Pruebas de Hipótesis</div>
                </div>
                
                <div class="skills-category">
                    <div class="skills-category-title">Bases de Datos y Herramientas</div>
                    <div class="skills-list">MySQL (Avanzado) • PostgreSQL (Básico) • Modelado de Datos • Git/GitHub • Jupyter Notebooks • APIs REST</div>
                </div>
                
                <div class="skills-category">
                    <div class="skills-category-title">Complementarias</div>
                    <div class="skills-list">JavaScript • PHP • HTML5/CSS3 • Shopify • Español (Nativo) • Inglés (Profesional-Avanzado)</div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Experiencia Profesional</h2>
                
                <div class="experience-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Desarrollador Web</div>
                            <div class="item-company">OK Latino | Ciudad de México</div>
                        </div>
                        <div class="item-date">Jun 2025 - Presente</div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li>Desarrollé +5 sitios e-commerce (Kings League Americas, Big and Tall) optimizando UX y reduciendo tiempos de carga 25%</li>
                            <li>Implementé soluciones con HTML5, CSS3, JavaScript y Shopify aplicando metodologías ágiles</li>
                        </ul>
                    </div>
                </div>
                
                <div class="experience-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Colaborador TI</div>
                            <div class="item-company">Instituto Mejoramiento Judicial | Guerrero</div>
                        </div>
                        <div class="item-date">Jul 2022 - Ago 2023</div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li>Gestioné procesos audiovisuales para +150 audiencias mensuales sin interrupciones críticas</li>
                            <li>Reduje incidencias técnicas 20% implementando mantenimiento preventivo sistemático</li>
                            <li>Automaticé procesos desarrollando 3 aplicaciones PHP, reduciendo tiempo de gestión manual 40%</li>
                        </ul>
                    </div>
                </div>
                
                <div class="experience-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Soporte TI y Ventas</div>
                            <div class="item-company">Pachateca | Guerrero</div>
                        </div>
                        <div class="item-date">Jul 2017 - Feb 2020</div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li>Soporte técnico a +50 clientes semanalmente con 95% satisfacción</li>
                            <li>Contribuí al crecimiento de ventas 60% mediante análisis estratégico de inventario</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Proyectos Destacados</h2>
                
                <div class="project-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Análisis de Factores de Éxito en Videojuegos</div>
                            <div class="item-subtitle">EDA y Pruebas de Hipótesis - Data Analytics (2025)</div>
                        </div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li><strong>Problema:</strong> Identificar factores clave para optimizar estrategias de lanzamiento</li>
                            <li><strong>Dataset:</strong> +16,000 registros de ventas (1980-2016) | <strong>Stack:</strong> Python, Pandas, NumPy, Matplotlib, Seaborn</li>
                            <li><strong>Resultado:</strong> Identifiqué géneros con 15% mayor probabilidad de éxito + dashboard Power BI con DAX | <a href="https://github.com/Baltazardv/Ice-Online-Store" target="_blank">GitHub</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="project-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">GymSpot - Aplicación de Localización</div>
                            <div class="item-subtitle">Full-Stack Development (2023)</div>
                        </div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li><strong>Problema:</strong> Localización de gimnasios con filtrado avanzado | <strong>Usuarios:</strong> +100 beta testers</li>
                            <li><strong>Stack:</strong> JavaScript ES6, APIs geolocalización | <strong>Resultado:</strong> Reducción 50% tiempo búsqueda | <a href="https://github.com/Baltazardv/ProyectoGymSpot" target="_blank">GitHub</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">Educación y Certificaciones</h2>
                
                <div class="education-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Bootcamp Analista de Datos</div>
                            <div class="item-company">TripleTen</div>
                        </div>
                        <div class="item-date">En curso (2025)</div>
                    </div>
                    <div class="item-content">
                        <ul>
                            <li>EDA, SQL avanzado, Python/Pandas, Power BI, dashboards, hipótesis estadísticas, storytelling con KPIs</li>
                        </ul>
                    </div>
                </div>
                
                <div class="education-item">
                    <div class="item-header">
                        <div class="item-details">
                            <div class="item-title">Ingeniería en Computación</div>
                            <div class="item-company">Universidad Autónoma de Guerrero</div>
                        </div>
                        <div class="item-date">Feb 2018 - May 2023</div>
                    </div>
                </div>
                
                <div class="item-content">
                    <ul>
                        <li><strong>Certificaciones:</strong> Python Essentials 1&2 (CISCO) • Front-End Profesional (Código Facilito) • Seguridad de Red (Palo Alto)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Cover Letter Version -->
    <div class="cover-letter-container" id="cover-letter-content">
        <div class="letter-header">
            <div class="letter-date">Guerrero, México<br>23 de septiembre de 2025</div>
        </div>
        
        <div class="letter-recipient">
            <strong>Equipo de Recursos Humanos<br>
            Afirma Solutions<br>
            Ciudad de México</strong>
        </div>
        
        <div class="letter-greeting">
            Estimado equipo de reclutamiento:
        </div>
        
        <div class="letter-body">
            <p>Me dirijo a ustedes para expresar mi interés en la posición de <strong>Data Analyst (Power BI)</strong> (ID: 1009873612255) publicada en Glassdoor. Como Ingeniero en Computación titulado con especialización actual en análisis de datos y experiencia práctica en <strong>SQL avanzado, Python, Power BI, modelado de datos y desarrollo de medidas DAX</strong>, considero que mi perfil técnico y mi enfoque hacia la inteligencia de negocios pueden aportar valor significativo a Afirma Solutions.</p>
            
            <p>Mi formación académica en Ingeniería en Computación me ha proporcionado una base sólida en tecnologías fundamentales para el análisis de datos. Actualmente completo mi especialización en Data Analytics en TripleTen, donde he profundizado en <strong>análisis exploratorio de datos (EDA), limpieza y transformación de datasets, desarrollo de medidas DAX avanzadas, modelado estrella, SQL complejas y storytelling con KPIs empresariales</strong>. Como ejemplo concreto, desarrollé un proyecto de análisis de factores de éxito en la industria de videojuegos donde apliqué Python (Pandas, NumPy, Matplotlib) para analizar +16,000 registros, creé un dashboard interactivo en Power BI con medidas DAX personalizadas que identificó géneros con +15% mayor probabilidad de éxito comercial, y desarrollé filtros dinámicos para visualizar patrones de ventas regionales que facilitaron la toma de decisiones estratégicas basadas en datos.</p>
            
            <p>En términos de experiencia práctica, he automatizado procesos empresariales mediante desarrollo de aplicaciones que redujeron 40% el tiempo de gestión manual, gestioné procesos técnicos para +150 operaciones mensuales sin interrupciones críticas, y contribuí a un crecimiento de ventas del 60% mediante análisis estratégico de inventario y optimización de rotación de productos. Esta experiencia me ha enseñado la importancia de traducir datos complejos en insights accionables para la toma de decisiones ejecutivas.</p>
            
            <p>Me atrae particularmente Afirma Solutions por su especialización en <strong>consultoría tecnológica y financiera</strong>, sectores donde el análisis de datos es crucial para optimizar operaciones, identificar oportunidades de crecimiento y desarrollar estrategias basadas en Business Intelligence. Su enfoque en <strong>transformación digital, DevSecOps y Big Data</strong> se alinea perfectamente con mi objetivo profesional de aplicar análisis avanzado de datos para generar valor empresarial. Además, valoro el <strong>esquema híbrido</strong> que ofrecen, ya que me permitiría equilibrar el trabajo colaborativo presencial con la flexibilidad del trabajo remoto, y confirmo mi disponibilidad para viajar mensualmente a las instalaciones según las necesidades del proyecto.</p>
            
            <p>Mi experiencia técnica incluye el dominio de <strong>SQL para consultas complejas y optimización de bases de datos, Python para análisis estadístico avanzado, Power BI para desarrollo de dashboards ejecutivos, y modelado de datos relacionales</strong>. Además, mi background en desarrollo web me ha proporcionado habilidades complementarias en APIs REST y gestión de datos que son valiosas para integración de sistemas y automatización de procesos de ETL.</p>
            
            <p>Estoy entusiasmado por la oportunidad de aplicar mis conocimientos en <strong>análisis de datos, Power BI, SQL avanzado y modelado estrella</strong> en un entorno empresarial dinámico como Afirma Solutions. Mi enfoque de autogestión, comunicación efectiva y orientación hacia resultados de negocio me permitirá integrarme exitosamente a su equipo y contribuir al crecimiento de sus proyectos de Business Intelligence y transformación digital.</p>
        </div>
        
        <div class="letter-closing">
            Sin más por el momento, agradezco su tiempo y consideración. Quedo a la espera de la oportunidad de conversar sobre cómo puedo contribuir al éxito de Afirma Solutions aportando valor mediante análisis de datos avanzado y Business Intelligence.
        </div>
        
        <div class="letter-signature">
            Atentamente,<br><br>
            <strong>Baltazar Dimayuga</strong><br>
            Tel: (+52) 747 155 8247<br>
            Email: baltazardv13@gmail.com<br>
            LinkedIn: www.linkedin.com/in/baltazar-dimayuga-4000a2293<br>
            GitHub: github.com/BaltazarDV
        </div>
    </div>
    
    <!-- Información de la vacante -->
    <div class="download-buttons">
        <div class="view-buttons">
            <button class="view-btn active" onclick="showCV()">Ver CV</button>
            <button class="view-btn" onclick="showCoverLetter()">Ver Cover Letter</button>
        </div>
        
        <div class="buttons-row">
            <button class="download-btn" onclick="downloadAsPDF()">Descargar PDF</button>
            <button class="download-btn" onclick="downloadAsDOCX()">Descargar DOCX</button>
        </div>
        
        <div class="job-link-container" id="job-link-container">
            <h3>Información de la Vacante</h3>
            <p><strong>Empresa:</strong> Afirma Solutions</p>
            <p><strong>Posición:</strong> Data Analyst (Power BI)</p>
            <p><strong>ID de Vacante:</strong> 1009873612255</p>
            <p><strong>Fuente:</strong> Glassdoor México</p>
            <br>
            <a href="https://www.glassdoor.com.mx/job-listing/data-analyst-power-bi-afirma-solutions-JV_KO0,21_KE22,38.htm?jl=1009873612255" target="_blank" class="job-btn">Ver Vacante en Glassdoor</a>
        </div>
    </div>

    <script>
        function showCV() {
            document.getElementById('cv-content').style.display = 'block';
            document.getElementById('cover-letter-content').style.display = 'none';
            document.getElementById('job-link-container').style.display = 'none';
            document.querySelector('.view-btn:nth-of-type(1)').classList.add('active');
            document.querySelector('.view-btn:nth-of-type(2)').classList.remove('active');
        }
        
        function showCoverLetter() {
            document.getElementById('cv-content').style.display = 'none';
            document.getElementById('cover-letter-content').style.display = 'block';
            document.getElementById('job-link-container').style.display = 'block';
            document.querySelector('.view-btn:nth-of-type(1)').classList.remove('active');
            document.querySelector('.view-btn:nth-of-type(2)').classList.add('active');
        }

        function downloadAsPDF() {
            const isCV = document.getElementById('cv-content').style.display !== 'none';
            const fileName = isCV ? 'CV_Baltazar_Dimayuga_ATS.pdf' : 'Cover_Letter_Baltazar_Dimayuga_Afirma.pdf';
            
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            // Configuración inicial redistribuida
            let yPos = 20;
            const margin = 20;
            const pageWidth = 210;
            const pageHeight = 297;
            const maxWidth = pageWidth - (margin * 2);
            const bottomMargin = 15;
            
            // Función para verificar y agregar nueva página si es necesario
            function checkAndAddPage(spaceNeeded = 12) {
                if (yPos + spaceNeeded > pageHeight - bottomMargin) {
                    pdf.addPage();
                    yPos = 20;
                    return true;
                }
                return false;
            }
            
            if (isCV) {
                // Header con mejor espaciado
                pdf.setFontSize(18);
                pdf.setFont(undefined, 'bold');
                pdf.text('BALTAZAR DIMAYUGA', pageWidth/2, yPos, { align: 'center' });
                yPos += 8;
                
                pdf.setFontSize(12);
                pdf.setFont(undefined, 'normal');
                pdf.text('Data Analyst Jr | Business Intelligence', pageWidth/2, yPos, { align: 'center' });
                yPos += 10;
                
                // Contacto
                pdf.setFontSize(9);
                pdf.setFont(undefined, 'normal');
                
                // Primera línea de contacto
                const contactLine1 = 'Teléfono: (+52) 747 155 8247  Email: ';
                const emailText = 'baltazardv13@gmail.com';
                const locationText = '  Ubicación: Guerrero, México';
                
                const line1Y = yPos;
                pdf.text(contactLine1, pageWidth/2 - 85, line1Y);
                
                // Email clickeable
                pdf.setTextColor(0, 0, 255);
                pdf.text(emailText, pageWidth/2 - 25, line1Y);
                pdf.link(pageWidth/2 - 25, line1Y - 2, 45, 4, {url: 'mailto:baltazardv13@gmail.com'});
                pdf.setTextColor(0, 0, 0);
                
                pdf.text(locationText, pageWidth/2 + 20, line1Y);
                yPos += 4;
                
                // Segunda línea de contacto
                const githubLabel = 'GitHub: ';
                const githubLink = 'github.com/BaltazarDV';
                const linkedinLabel = '  LinkedIn: ';
                const linkedinLink = 'linkedin.com/in/baltazar-dimayuga';
                
                const line2Y = yPos;
                pdf.text(githubLabel, pageWidth/2 - 60, line2Y);
                
                // GitHub clickeable
                pdf.setTextColor(0, 0, 255);
                pdf.text(githubLink, pageWidth/2 - 45, line2Y);
                pdf.link(pageWidth/2 - 45, line2Y - 2, 40, 4, {url: 'https://github.com/BaltazarDV'});
                pdf.setTextColor(0, 0, 0);
                
                pdf.text(linkedinLabel, pageWidth/2 - 5, line2Y);
                
                // LinkedIn clickeable
                pdf.setTextColor(0, 0, 255);
                pdf.text(linkedinLink, pageWidth/2 + 15, line2Y);
                pdf.link(pageWidth/2 + 15, line2Y - 2, 55, 4, {url: 'https://www.linkedin.com/in/baltazar-dimayuga-4000a2293'});
                pdf.setTextColor(0, 0, 0);
                
                yPos += 6;
                
                // Línea separadora
                pdf.line(margin, yPos, pageWidth - margin, yPos);
                yPos += 8;
                
                // Perfil Profesional con mejor espaciado
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.text('PERFIL PROFESIONAL', margin, yPos);
                yPos += 6;
                
                pdf.setFontSize(9);
                pdf.setFont(undefined, 'normal');
                const perfilText = 'Analista de Datos Jr e Ingeniero en Computación especializado en Python, SQL, Power BI y visualización de datos. Experiencia comprobada en automatización de procesos (reducción del 40% en tiempos), optimización técnica (disminución del 20% en incidencias) y crecimiento empresarial (incremento del 60% en ventas). Busco aplicar mis habilidades analíticas como Data Analyst Jr para generar valor empresarial mediante Business Intelligence.';
                const perfilLines = pdf.splitTextToSize(perfilText, maxWidth);
                pdf.text(perfilLines, margin, yPos);
                yPos += perfilLines.length * 4 + 6;
                
                // Habilidades Técnicas con espaciado mejorado
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.text('HABILIDADES TÉCNICAS E IDIOMAS', margin, yPos);
                yPos += 6;
                
                pdf.setFontSize(8);
                pdf.setFont(undefined, 'bold');
                pdf.text('ANÁLISIS DE DATOS Y BI', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                const skillsLine1 = pdf.splitTextToSize('Python (Avanzado) • SQL (Avanzado) • Pandas/NumPy (Avanzado) • Power BI (Intermedio) • Tableau (Básico) • Excel Avanzado • Matplotlib/Seaborn • EDA • Pruebas de Hipótesis', maxWidth);
                pdf.text(skillsLine1, margin, yPos);
                yPos += skillsLine1.length * 3.2 + 3;
                
                pdf.setFont(undefined, 'bold');
                pdf.text('BASES DE DATOS Y HERRAMIENTAS', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                pdf.text('MySQL (Avanzado) • PostgreSQL (Básico) • Modelado de Datos • Git/GitHub • Jupyter Notebooks • APIs REST', margin, yPos);
                yPos += 6;
                
                pdf.setFont(undefined, 'bold');
                pdf.text('COMPLEMENTARIAS', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                pdf.text('JavaScript • PHP • HTML5/CSS3 • Shopify • Español (Nativo) • Inglés (Profesional-Avanzado)', margin, yPos);
                yPos += 8;
                
                // Experiencia Profesional con mejor espaciado
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.text('EXPERIENCIA PROFESIONAL', margin, yPos);
                yPos += 6;
                
                // Trabajos con espaciado mejorado
                const trabajos = [
                    {
                        titulo: 'Desarrollador Web',
                        empresa: 'OK Latino | Ciudad de México',
                        fecha: 'Jun 2025 - Presente',
                        bullets: [
                            'Desarrollé +5 sitios e-commerce (Kings League Americas, Big and Tall) optimizando UX y reduciendo tiempos de carga 25%',
                            'Implementé soluciones con HTML5, CSS3, JavaScript y Shopify aplicando metodologías ágiles'
                        ]
                    },
                    {
                        titulo: 'Colaborador TI',
                        empresa: 'Instituto Mejoramiento Judicial | Guerrero',
                        fecha: 'Jul 2022 - Ago 2023',
                        bullets: [
                            'Gestioné procesos audiovisuales para +150 audiencias mensuales sin interrupciones críticas',
                            'Reduje incidencias técnicas 20% implementando mantenimiento preventivo sistemático',
                            'Automaticé procesos desarrollando 3 aplicaciones PHP, reduciendo tiempo de gestión manual 40%'
                        ]
                    },
                    {
                        titulo: 'Soporte TI y Ventas',
                        empresa: 'Pachateca | Guerrero',
                        fecha: 'Jul 2017 - Feb 2020',
                        bullets: [
                            'Soporte técnico a +50 clientes semanalmente con 95% satisfacción',
                            'Contribuí al crecimiento de ventas 60% mediante análisis estratégico de inventario'
                        ]
                    }
                ];
                
                trabajos.forEach(trabajo => {
                    pdf.setFontSize(9);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(trabajo.titulo, margin, yPos);
                    pdf.setFont(undefined, 'normal');
                    pdf.text(trabajo.fecha, pageWidth - margin - 30, yPos);
                    yPos += 4;
                    pdf.setFont(undefined, 'italic');
                    pdf.text(trabajo.empresa, margin, yPos);
                    yPos += 4;
                    
                    pdf.setFont(undefined, 'normal');
                    trabajo.bullets.forEach(bullet => {
                        const bulletLines = pdf.splitTextToSize('• ' + bullet, maxWidth - 5);
                        pdf.text(bulletLines, margin + 3, yPos);
                        yPos += bulletLines.length * 3.5;
                    });
                    yPos += 3;
                });
                
                // Proyectos Destacados con mejor espaciado
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.text('PROYECTOS DESTACADOS', margin, yPos);
                yPos += 6;
                
                // Proyecto 1 con espaciado mejorado
                pdf.setFontSize(9);
                pdf.setFont(undefined, 'bold');
                pdf.text('Análisis de Factores de Éxito en Videojuegos', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'italic');
                pdf.text('EDA y Pruebas de Hipótesis - Data Analytics (2025)', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                
                const proyecto1Bullets = [
                    'Problema: Identificar factores clave para optimizar estrategias de lanzamiento',
                    'Dataset: +16,000 registros de ventas (1980-2016) | Stack: Python, Pandas, NumPy, Matplotlib, Seaborn',
                    'Resultado: Identifiqué géneros con 15% mayor probabilidad de éxito + dashboard Power BI con DAX'
                ];
                
                proyecto1Bullets.forEach(bullet => {
                    const bulletLines = pdf.splitTextToSize('• ' + bullet, maxWidth - 5);
                    pdf.text(bulletLines, margin + 3, yPos);
                    yPos += bulletLines.length * 3.5;
                });
                
                // Link funcional
                pdf.setTextColor(0, 0, 255);
                pdf.text('• GitHub: github.com/Baltazardv/Ice-Online-Store', margin + 3, yPos);
                pdf.link(margin + 13, yPos - 2, 80, 4, {url: 'https://github.com/Baltazardv/Ice-Online-Store'});
                pdf.setTextColor(0, 0, 0);
                yPos += 5;
                
                // Proyecto 2 con espaciado mejorado
                pdf.setFont(undefined, 'bold');
                pdf.text('GymSpot - Aplicación de Localización', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'italic');
                pdf.text('Full-Stack Development (2023)', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                
                const proyecto2Bullets = [
                    'Problema: Localización de gimnasios con filtrado avanzado | Usuarios: +100 beta testers',
                    'Stack: JavaScript ES6, APIs geolocalización | Resultado: Reducción 50% tiempo búsqueda'
                ];
                
                proyecto2Bullets.forEach(bullet => {
                    const bulletLines = pdf.splitTextToSize('• ' + bullet, maxWidth - 5);
                    pdf.text(bulletLines, margin + 3, yPos);
                    yPos += bulletLines.length * 3.5;
                });
                
                // Link funcional
                pdf.setTextColor(0, 0, 255);
                pdf.text('• GitHub: github.com/Baltazardv/ProyectoGymSpot', margin + 3, yPos);
                pdf.link(margin + 13, yPos - 2, 80, 4, {url: 'https://github.com/Baltazardv/ProyectoGymSpot'});
                pdf.setTextColor(0, 0, 0);
                yPos += 8;
                
                // Educación y Certificaciones con mejor distribución
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.text('EDUCACIÓN Y CERTIFICACIONES', margin, yPos);
                yPos += 6;
                
                pdf.setFontSize(9);
                pdf.setFont(undefined, 'bold');
                pdf.text('Bootcamp Analista de Datos', margin, yPos);
                pdf.setFont(undefined, 'normal');
                pdf.text('En curso (2025)', pageWidth - margin - 25, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'italic');
                pdf.text('TripleTen', margin, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'normal');
                const bootcampText = pdf.splitTextToSize('• EDA, SQL avanzado, Python/Pandas, Power BI, dashboards, hipótesis estadísticas, storytelling con KPIs', maxWidth - 5);
                pdf.text(bootcampText, margin + 3, yPos);
                yPos += bootcampText.length * 3.5 + 4;
                
                pdf.setFont(undefined, 'bold');
                pdf.text('Ingeniería en Computación', margin, yPos);
                pdf.setFont(undefined, 'normal');
                pdf.text('Feb 2018 - May 2023', pageWidth - margin - 30, yPos);
                yPos += 4;
                pdf.setFont(undefined, 'italic');
                pdf.text('Universidad Autónoma de Guerrero', margin, yPos);
                yPos += 6;
                
                // Certificaciones con tamaño mejorado y mejor espaciado
                pdf.setFontSize(8.5);
                pdf.setFont(undefined, 'normal');
                const certText = pdf.splitTextToSize('• Certificaciones: Python Essentials 1&2 (CISCO) • Front-End Profesional (Código Facilito) • Seguridad de Red (Palo Alto)', maxWidth - 5);
                pdf.text(certText, margin + 3, yPos);
                
            } else {
                // Cover Letter content (sin cambios significativos)
                yPos = 30;
                pdf.setFontSize(10);
                pdf.text('Guerrero, México', pageWidth - margin, yPos, { align: 'right' });
                yPos += 4;
                pdf.text('23 de septiembre de 2025', pageWidth - margin, yPos, { align: 'right' });
                yPos += 15;
                
                pdf.setFont(undefined, 'bold');
                pdf.text('Equipo de Recursos Humanos', margin, yPos);
                yPos += 4;
                pdf.text('Afirma Solutions', margin, yPos);
                yPos += 4;
                pdf.text('Ciudad de México', margin, yPos);
                yPos += 15;
                
                pdf.setFont(undefined, 'normal');
                pdf.text('Estimado equipo de reclutamiento:', margin, yPos);
                yPos += 10;
                
                // Contenido de la carta
                const parrafos = [
                    'Me dirijo a ustedes para expresar mi interés en la posición de Data Analyst (Power BI) (ID: 1009873612255) publicada en Glassdoor. Como Ingeniero en Computación titulado con especialización actual en análisis de datos y experiencia práctica en SQL avanzado, Python, Power BI, modelado de datos y desarrollo de medidas DAX, considero que mi perfil técnico y mi enfoque hacia la inteligencia de negocios pueden aportar valor significativo a Afirma Solutions.',
                    
                    'Mi formación académica en Ingeniería en Computación me ha proporcionado una base sólida en tecnologías fundamentales para el análisis de datos. Actualmente completo mi especialización en Data Analytics en TripleTen, donde he profundizado en análisis exploratorio de datos (EDA), limpieza y transformación de datasets, desarrollo de medidas DAX avanzadas, modelado estrella, SQL complejas y storytelling con KPIs empresariales.',
                    
                    'En términos de experiencia práctica, he automatizado procesos empresariales mediante desarrollo de aplicaciones que redujeron 40% el tiempo de gestión manual, gestioné procesos técnicos para +150 operaciones mensuales sin interrupciones críticas, y contribuí a un crecimiento de ventas del 60% mediante análisis estratégico de inventario.',
                    
                    'Me atrae particularmente Afirma Solutions por su especialización en consultoría tecnológica y financiera, sectores donde el análisis de datos es crucial para optimizar operaciones, identificar oportunidades de crecimiento y desarrollar estrategias basadas en Business Intelligence.',
                    
                    'Estoy entusiasmado por la oportunidad de aplicar mis conocimientos en análisis de datos, Power BI, SQL avanzado y modelado estrella en un entorno empresarial dinámico como Afirma Solutions.',
                    
                    'Sin más por el momento, agradezco su tiempo y consideración. Quedo a la espera de la oportunidad de conversar sobre cómo puedo contribuir al éxito de Afirma Solutions aportando valor mediante análisis de datos avanzado y Business Intelligence.'
                ];
                
                parrafos.forEach(parrafo => {
                    checkAndAddPage(20);
                    const lines = pdf.splitTextToSize(parrafo, maxWidth);
                    pdf.text(lines, margin, yPos);
                    yPos += lines.length * 4 + 8;
                });
                
                yPos += 10;
                checkAndAddPage(15);
                pdf.text('Atentamente,', margin, yPos);
                yPos += 15;
                pdf.setFont(undefined, 'bold');
                pdf.text('Baltazar Dimayuga', margin, yPos);
                yPos += 5;
                pdf.setFont(undefined, 'normal');
                pdf.text('Tel: (+52) 747 155 8247', margin, yPos);
                yPos += 4;
                pdf.text('Email: baltazardv13@gmail.com', margin, yPos);
                yPos += 4;
                
                // Links funcionales en firma
                pdf.setTextColor(0, 0, 255);
                pdf.text('LinkedIn: linkedin.com/in/baltazar-dimayuga', margin, yPos);
                pdf.link(margin + 20, yPos - 2, 80, 4, {url: 'https://www.linkedin.com/in/baltazar-dimayuga-4000a2293'});
                yPos += 4;
                pdf.text('GitHub: github.com/BaltazarDV', margin, yPos);
                pdf.link(margin + 15, yPos - 2, 60, 4, {url: 'https://github.com/BaltazarDV'});
                pdf.setTextColor(0, 0, 0);
            }
            
            pdf.save(fileName);
        }

        function downloadAsDOCX() {
            const isCV = document.getElementById('cv-content').style.display !== 'none';
            const fileName = isCV ? 'CV_Baltazar_Dimayuga_ATS.doc' : 'Cover_Letter_Baltazar_Dimayuga_Afirma.doc';

            const contentElement = isCV ? document.getElementById('cv-content') : document.getElementById('cover-letter-content');
            const textContent = extractFormattedTextForDOC(contentElement);

            const blob = new Blob([textContent], {
                type: 'application/msword;charset=utf-8'
            });

            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function extractFormattedTextForDOC(element) {
            let text = '';
            const walkNodes = (node) => {
                if (node.nodeType === Node.TEXT_NODE) {
                    const content = node.textContent.trim();
                    if (content) {
                        text += content + ' ';
                    }
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    const tagName = node.tagName.toLowerCase();
                    const classList = node.classList;
        
                    if (tagName === 'h1') {
                        text += '\n\n' + node.textContent.toUpperCase().trim() + '\n';
                        text += '='.repeat(node.textContent.length) + '\n\n';
                    } else if (classList.contains('section-title') || tagName === 'h2') {
                        text += '\n\n' + node.textContent.toUpperCase().trim() + '\n';
                        text += '-'.repeat(node.textContent.length) + '\n';
                    } else if (classList.contains('item-title')) {
                        text += '\n' + node.textContent.trim() + '\n';
                    } else if (classList.contains('item-company')) {
                        text += node.textContent.trim() + '\n';
                    } else if (classList.contains('item-date')) {
                        text += node.textContent.trim() + '\n';
                    } else if (tagName === 'li') {
                        text += '  • ' + node.textContent.trim() + '\n';
                    } else if (tagName === 'a' && node.href) {
                        text += node.textContent.trim() + ' (' + node.href + ') ';
                    } else if (tagName === 'p') {
                        text += '\n' + node.textContent.trim() + '\n';
                    } else {
                        for (let child of node.childNodes) {
                            walkNodes(child);
                        }
                    }
                }
            };
            walkNodes(element);
            return text.replace(/\n\s*\n\s*/g, '\n\n').trim();
        }

        // Initialize CV view on load
        document.addEventListener('DOMContentLoaded', function() {
            showCV();
        });
    </script>
</body>
</html>